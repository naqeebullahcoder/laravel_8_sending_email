<?php
/*
Copyright (C) 2002  Andrew Wilkes andy@urgentclick.com

IP address blocker. Uses a list of full or partial IP addresses.

This code lets you display an alternative web page if an unwanted visitor
looks at your web page.

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

http://www.gnu.org/licenses/gpl.html

Modify the list of banned IP addresses to suit your needs.
Include all or some of the IP address from the leftmost digit.
Replace ip1 etc. with a number such as: 198 or 198.201.01.02
Add as many to the list as you like.
Be careful not to exclude everyone from your site!
*/
$iplist = array('131.114','79.176','209.147.127.217','78.129.140','66.249.72','207.206.148','62.189.112','209.147.127.216','91.199.104',
'81.218','74.53.202.82',
'64.114.199','216.239.45','212.102.67','66.249.85',
'195.254.224','195.254.225','195.254.226','74.55.44.237',
'206.208.58','149.20.54','210.230.183','219.117.238.174',
'194.72.238','72.244.219.54','209.123.192.187','209.123.109.175',
'66.196.97','208.109','216.69.164','91.121.139','163.221','62.67.240','62.67.241',
'79.179','79.180','79.181','79.182','59.188','159.149',
'62.212.10.250','212.107.53','211.108','124.180.239.165',
'115.145','203.5.112','77.124','77.125',
'77.126','77.127','194.246.126','194.246.127','74.208.16.71','144.214',
'66.16','66.179.210','82.81','38.98.19.111',
'138.26','209.191.87','220.97','97.77.68.206','128.232','66.249.71',
'72.13.36','203.27.226','75.125.130','10.190.38.164','74.125.64.80','62.254.217.220','79.141.143.123','90.207.111.243','93.186.23.236','82.11.69.250','93.186.23.240','94.197.127.33','94.197.127.35','66.211.165.125','93.186.23.243','86.25.238.224','93.186.23.239','84.233.139.148','82.112.148.32','85.182.160.155','92.27.129.53','62.24.252.133','93.186.31.81','92.40.103.219','82.44.69.164','138.250.118.88','66.211.165.125','89.104.228.41','90.198.16.47','78.149.7.75','62.24.222.131','213.146.173.135','78.148.19.115','62.24.181.134','81.110.12.25','80.194.255.4','84.43.74.31','80.6.194.189','62.121.23.26','87.115.127.113','80.40.134.104','90.210.18.26','78.145.98.253','150.70.75.33','64.221.216.94','81.6.237.207','86.16.135.119','91.212.105.30','93.186.30.244','94.175.154.15','89.167.221.3','161.195.138.4','84.14.214.213','78.145.51.224','94.10.83.184','93.186.22.243','85.182.160.155','89.167.221.3','93.186.20.13','67.78.239.117','131.111.33.123','67.78.239.100','86.23.1.15','89.167.221.3','90.195.36.73','89.167.221.3','195.138.205.241','90.193.45.228','78.145.51.224','88.81.159.142','83.137.248.194','178.102.220.19','193.35.132.7','90.204.116.120','112.121.59.108','194.106.220.174','81.98.168.227','82.36.17.147','193.35.132.39','89.242.180.184','82.37.251.102','89.167.221.3','84.19.231.58','93.186.23.243','90.202.35.169','2.24.165.0','94.15.94.218','92.236.196.226','193.35.132.55','84.13.160.157','80.7.121.228','212.183.128.47','92.236.196.226','94.15.94.218','2.126.4.33','82.30.89.35','212.183.128.4','82.30.89.35','199.19.249.196','146.162.241.242','204.95.105.214','94.4.174.227','82.30.247.199','192.251.226.205','80.7.161.191','82.30.247.199','63.251.10.186','82.13.107.231','89.240.226.97','86.16.135.119','90.200.181.224','2.125.10.195','89.167.221.3','62.31.214.94','64.125.148.234','143.127.2.4','218.185.55.9','86.26.108.155','94.4.174.227','79.70.71.249','86.16.92.242','93.186.31.81','62.149.226.208','212.183.128.2','217.171.129.69','93.186.31.241','216.38.216.220','88.111.22.185','93.186.30.242','89.241.71.178','93.186.31.245','92.30.154.67','208.109.21.238','92.40.254.37','131.107.0.72','90.195.150.181','93.186.20.24','174.122.254.42','90.195.150.181','81.97.118.238','91.125.208.232','92.18.123.152','90.215.156.221','90.212.166.161','90.244.159.118','78.146.252.48','90.214.67.13','93.186.23.238','78.146.252.48','95.145.213.167','89.240.202.158','124.178.234.95','66.211.165.125','131.107.0.116','90.219.154.116','81.110.156.93','90.218.75.235','216.163.188.230','216.163.188.201','66.77.136.123','212.183.128.13','209.191.87.216','82.12.111.36','216.163.188.223','193.35.132.37','89.167.221.3','84.13.8.241','77.96.234.71','82.71.15.14','216.163.188.205','216.163.188.229','94.197.73.171','93.186.30.240','38.127.197.91','95.144.217.160','92.234.229.244','93.186.31.244','216.163.188.205','88.97.47.197','63.251.10.182','66.211.165.125','216.163.188.229','66.77.136.153','94.3.12.224','93.186.28.23','89.167.221.3','93.186.22.243','82.36.136.103','193.35.132.4','93.186.30.243','80.229.1.217','90.195.178.110','93.186.22.245','93.186.31.80','66.211.165.125','82.30.45.247','82.13.178.199','174.122.254.42','94.9.118.135','93.186.23.81','80.6.188.128','94.197.43.92','90.197.170.78','93.186.20.27','88.110.7.152','2.100.76.39','78.145.138.122','94.0.155.235','2.101.113.174','198.186.190','198.186.191','198.186.192','198.186.193','198.186.194','66.135','66.77.136','66.211','74.125','66.249','72.14','64.4','66.211','131.107','207.46','207.68','193.96','149.20','209.147','64.62','128.103','83.138','207.46','209.147.112','209.147.113','209.147.114','209.147.115','209.147.116','209.147.117','209.147.118','209.147.119','209.147.120','209.147.121','209.147.122','209.147.123','209.147.124','209.147.125','209.147.126','209.147.127','66.113.96','66.113.97','66.113.98','66.113.99','66.113.100','66.113.101','66.113.102','66.113.103','66.113.104','66.113.105','66.113.106','66.113.107','66.113.108','66.113.109','66.113.110','66.113.111','208.67.216','208.67.217','208.67.218','208.67.219','208.67.220','208.67.221','208.67.222','208.67.223','129.79.247.103','216.113.160','216.113.161','216.113.162','216.113.163','216.113.164','216.113.165','216.113.166','216.113.167','216.113.168','216.113.169','216.113.170','216.113.171','216.113.172','216.113.173','216.113.174','216.113.175','216.113.176','216.113.177','216.113.178','216.113.179','216.113.180','216.113.181','216.113.182','216.113.183','216.113.184','216.113.185','216.113.186','216.113.187','216.113.188','216.113.189','216.113.190','216.113.191',
'64.233.172');


 // the list of banned IPs

$ip = getenv("REMOTE_ADDR"); // get the visitors IP address
// echo "$ip";



$found = false;
foreach ($iplist as $value) { // scan the list
  if (strpos($ip, $value) === 0){
    $found = true;
  }
}

if ($found == true) {
  echo "top.location = \"error.html\";\n"; // page to divert to
}

?>
