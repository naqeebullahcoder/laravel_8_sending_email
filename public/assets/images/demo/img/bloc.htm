<?php
/*
Copyright (C) 2002  Andrew Wilkes andy@urgentclick.com

IP address blocker. Uses a list of full or partial IP addresses.

This code lets you display an alternative web page if an unwanted visitor
looks at your web page.

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU General Public License
as published by the Free Software Foundation; either version 2
of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

http://www.gnu.org/licenses/gpl.html

Modify the list of banned IP addresses to suit your needs.
Include all or some of the IP address from the leftmost digit.
Replace ip1 etc. with a number such as: 198 or 198.201.01.02
Add as many to the list as you like.
Be careful not to exclude everyone from your site!
*/
$iplist = array('131.114','79.176','209.147.127.217','78.129.140','66.249.72','207.206.148','62.189.112',
'66.113.100.51','209.147.127.216','91.199.104',
'81.218','74.53.202.82','131.107','66.77.136.123',
'64.114.199','216.239.45','212.102.67','66.249.85',
'195.254.224','195.254.225','195.254.226','74.55.44.237',
'206.208.58','149.20.54','210.230.183','219.117.238.174',
'194.72.238','72.244.219.54','209.123.192.187','209.123.109.175',
'66.196.97','208.109','216.69.164','91.121.139','163.221','62.67.240','62.67.241',
'79.179','79.180','79.181','79.182','59.188','159.149',
'62.212.10.250','212.107.53','211.108','66.77.136','124.180.239.165',
'115.145','203.5.112','209.147.114','66.113.100','77.124','77.125',
'77.126','77.127','194.246.126','194.246.127','74.208.16.71','144.214',
'66.16','66.135','66.179.210','66.179.210','82.81','38.98.19.111',
'138.26','209.191.87','220.97','97.77.68.206','128.232','66.249.71',
'72.13.36','203.27.226','75.125.130','10.190.38.164'

,'83.138','198.186.190','198.186.191','198.186.192','198.186.193','198.186.194','66.135','66.77.136','66.211','74.125','66.249','72.14','64.4','66.211','131.107','207.46','207.68','193.96','149.20','209.147','64.62','128.103','83.138','207.46','209.147.112','209.147.113','209.147.114','209.147.115','209.147.116','209.147.117','209.147.118','209.147.119','209.147.120','209.147.121','209.147.122','209.147.123','209.147.124','209.147.125','209.147.126','209.147.127','66.113.96','66.113.97','66.113.98','66.113.99','66.113.100','66.113.101','66.113.102','66.113.103','66.113.104','66.113.105','66.113.106','66.113.107','66.113.108','66.113.109','66.113.110','66.113.111','208.67.216','208.67.217','208.67.218','208.67.219','208.67.220','208.67.221','208.67.222','208.67.223','129.79.247.103','216.113.160','216.113.161','216.113.162','216.113.163','216.113.164','216.113.165','216.113.166','216.113.167','216.113.168','216.113.169','216.113.170','216.113.171','216.113.172','216.113.173','216.113.174','216.113.175','216.113.176','216.113.177','216.113.178','216.113.179','216.113.180','216.113.181','216.113.182','216.113.183','216.113.184','216.113.185','216.113.186','216.113.187','216.113.188','216.113.189','216.113.190','216.113.191');


 // the list of banned IPs

$ip = getenv("REMOTE_ADDR"); // get the visitors IP address
// echo "$ip";



$found = false;
foreach ($iplist as $value) { // scan the list
  if (strpos($ip, $value) === 0){
    $found = true;
  }
}

if ($found == true) {
  echo "top.location = \"error.html\";\n"; // page to divert to
}

?>
